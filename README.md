# Memory-X | æ™ºèƒ½åŒ»ç–—è®°å¿†ç®¡ç†ç³»ç»Ÿ

ğŸ“… **æœ€åæ›´æ–°**: 2025å¹´9æœˆ11æ—¥  
ğŸ‘¤ **é¡¹ç›®ç»´æŠ¤è€…**: æŸ³é˜³ï¼Œ40å²ï¼Œæœ‰ç³–å°¿ç—…é—ä¼ ç—…å²ï¼Œé’éœ‰ç´ è¿‡æ•  
ğŸ¥ **åº”ç”¨é¢†åŸŸ**: åŒ»ç–—AIã€æ™ºèƒ½è®°å¿†ç®¡ç†ã€çŸ¥è¯†å›¾è°±  

Memory-X æ˜¯ä¸€ä¸ªä¸“ä¸ºåŒ»ç–—AIåœºæ™¯è®¾è®¡çš„æ™ºèƒ½è®°å¿†ç®¡ç†ç³»ç»Ÿï¼Œå‚è€ƒ Google Vertex AI Memory Bank æ¶æ„ï¼Œæä¾›å±‚æ¬¡åŒ–è®°å¿†ç®¡ç†ã€åŒ»ç–—çŸ¥è¯†å›¾è°±æ„å»ºå’ŒAIé©±åŠ¨çš„æ™ºèƒ½åˆ†æèƒ½åŠ›ã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- ğŸ§  **å±‚æ¬¡åŒ–è®°å¿†ç®¡ç†**: çŸ­æœŸè®°å¿†ã€å·¥ä½œè®°å¿†ã€é•¿æœŸè®°å¿†çš„ç»Ÿä¸€ç®¡ç†
- ğŸ¥ **åŒ»ç–—AIä¸“ç”¨**: æ”¯æŒç³–å°¿ç—…ç­‰ç–¾ç—…çš„æ™ºèƒ½è¯Šæ–­å’Œé£é™©è¯„ä¼°
- ğŸ¤– **AIé©±åŠ¨æ›´æ–°**: é›†æˆç™¾ç‚¼Qwen3æ¨¡å‹ï¼Œå®ç°æ™ºèƒ½çŸ¥è¯†å›¾è°±æ›´æ–°
- ğŸ“Š **çŸ¥è¯†å›¾è°±**: åŒ»ç–—å®ä½“å…³ç³»å»ºæ¨¡ï¼Œæ”¯æŒç–¾ç—…-ç—‡çŠ¶-è¯ç‰©å…³è”
- ğŸ”Œ **å¯æ’æ‹”å­˜å‚¨**: æ”¯æŒSQLiteã€Cloud Spannerã€Mem0å¤šç§å­˜å‚¨åç«¯
- ğŸŒ **å…¨æ ˆæ¶æ„**: Reactå‰ç«¯ + Flaskåç«¯ + AIå¼•æ“é›†æˆ
- ğŸ©º **FHIRå…¼å®¹**: éµå¾ªåŒ»ç–—è¡Œä¸šæ ‡å‡†çš„æ•°æ®æ ¼å¼

## ğŸ’¡ åŒ»ç–—åº”ç”¨åœºæ™¯

### ğŸ¯ ç³–å°¿ç—…æ™ºèƒ½è¯Šæ–­
- **å®¶æ—å²é£é™©è¯„ä¼°**: åŸºäºæ‚£è€…å®¶æ—ç—…å²è¿›è¡Œç³–å°¿ç—…é£é™©åˆ†æ
- **ç—‡çŠ¶å…³è”åˆ†æ**: æ™ºèƒ½åˆ†æä¹åŠ›ã€å¤´æ™•ç­‰ç—‡çŠ¶ä¸ç³–å°¿ç—…çš„å…³è”æ€§
- **ç½®ä¿¡åº¦è¯„ä¼°**: æä¾›0.9+é«˜ç½®ä¿¡åº¦çš„è¯Šæ–­å»ºè®®
- **æ—¶é—´åºåˆ—åˆ†æ**: åŒºåˆ†ä¸åŒæ—¶æœŸçš„ç—‡çŠ¶ï¼Œé¿å…è¯¯è¯Š

### ğŸŒ åœ¨çº¿åŒ»ç–—å’¨è¯¢
- **å®æ—¶ç—‡çŠ¶åˆ†æ**: æ”¯æŒonline_consultæ¥æºçš„æ‚£è€…å’¨è¯¢
- **ä¸ªæ€§åŒ–å»ºè®®**: ç»“åˆæ‚£è€…å¹´é¾„ã€è¿‡æ•å²ã€å®¶æ—å²çš„ä¸ªæ€§åŒ–åŒ»ç–—å»ºè®®
- **ä¸“ä¸šå›å¤ç”Ÿæˆ**: ç¬¦åˆä¸´åºŠå®è·µçš„åŒ»ç”Ÿå›å¤è‡ªåŠ¨ç”Ÿæˆ

### ğŸ‘¤ æ‚£è€…è®°å¿†ç®¡ç†
- **è¿‡æ•å²ä¿æŠ¤**: è‡ªåŠ¨è®°å½•å’Œä¿æŠ¤æ‚£è€…è¿‡æ•ä¿¡æ¯ï¼ˆå¦‚é’éœ‰ç´ è¿‡æ•ï¼‰
### ğŸ“Š çŸ¥è¯†å›¾è°±æ„å»º
- **ç–¾ç—…-ç—‡çŠ¶å…³è”**: è‡ªåŠ¨å»ºç«‹ç–¾ç—…ä¸ç—‡çŠ¶çš„å…³è”å…³ç³»
- **è¯ç‰©-ç–¾ç—…å…³è”**: æ”¯æŒç–¾ç—…ä¸æ²»ç–—è¯ç‰©çš„å…³ç³»å»ºæ¨¡
- **åŠ¨æ€æ›´æ–°**: AIé©±åŠ¨çš„çŸ¥è¯†å›¾è°±å®æ—¶æ›´æ–°å’Œä¼˜åŒ–

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **Python 3.9+**: ä¸»è¦å¼€å‘è¯­è¨€
- **Flask 2.3.3**: Webæ¡†æ¶å’ŒRESTful API
- **SQLAlchemy 2.0.23**: ORMæ¡†æ¶å’Œæ•°æ®åº“ç®¡ç†
- **pandas 2.1.4**: æ•°æ®å¤„ç†å’Œåˆ†æ
- **DashScope API**: ç™¾çƒ¼Qwen3æ¨¡å‹é›†æˆ
- **pytest 7.4.3**: è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶

### å‰ç«¯æŠ€æœ¯æ ˆ
- **React 19**: ç°ä»£åŒ–å‰ç«¯æ¡†æ¶
- **TypeScript**: ç±»å‹å®‰å…¨çš„JavaScript
- **Material-UI v7**: ä¸°å¯Œçš„UIç»„ä»¶åº“
- **Vite**: é«˜æ€§èƒ½æ„å»ºå·¥å…·
- **Axios**: HTTPå®¢æˆ·ç«¯è¯·æ±‚åº“

### æ•°æ®å­˜å‚¨
- **SQLite**: é»˜è®¤æœ¬åœ°å¼€å‘æ•°æ®åº“
- **Cloud Spanner**: åˆ†å¸ƒå¼æ•°æ®åº“æ”¯æŒ
- **Mem0**: å‘é‡åŒ–è®°å¿†å­˜å‚¨é›†æˆ

## ğŸ¤– ç™¾çƒ¼APIç»Ÿä¸€å®¢æˆ·ç«¯é…ç½®

é¡¹ç›®ä½¿ç”¨ç»Ÿä¸€çš„ç™¾çƒ¼APIå®¢æˆ·ç«¯é…ç½®ï¼Œæä¾›æ ‡å‡†åŒ–çš„AIæ¨¡å‹è®¿é—®èƒ½åŠ›ï¼š

### å®¢æˆ·ç«¯ç±»å‹
- **StandardDashScopeClient**: æ ‡å‡†é€šç”¨å®¢æˆ·ç«¯
- **MedicalDashScopeClient**: åŒ»ç–—ä¸“ç”¨å®¢æˆ·ç«¯ï¼ˆé»˜è®¤ï¼‰
- **StreamingDashScopeClient**: æµå¼å¤„ç†å®¢æˆ·ç«¯

### å¿«é€Ÿä½¿ç”¨
```python
from configs.dashscope_client import DashScopeClientFactory, quick_ask

# åˆ›å»ºåŒ»ç–—ä¸“ç”¨å®¢æˆ·ç«¯
client = DashScopeClientFactory.create_medical_client()

# å¿«é€Ÿæé—®
answer = quick_ask("ç³–å°¿ç—…çš„æ—©æœŸç—‡çŠ¶æœ‰å“ªäº›ï¼Ÿ")

# åŒ»ç–—å’¨è¯¢
from configs.dashscope_client import medical_consultation
result = medical_consultation(["å¤´æ™•", "ä¹åŠ›", "å¤šé¥®"])

# è¯ç‰©å®‰å…¨æ£€æŸ¥
from configs.dashscope_client import check_medication_safety
safety = check_medication_safety("äºŒç”²åŒèƒ")
```

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# è®¾ç½®ç™¾çƒ¼APIå¯†é’¥
export DASHSCOPE_API_KEY=your-api-key-here

# æˆ–åˆ›å»º.envæ–‡ä»¶
echo "DASHSCOPE_API_KEY=your-api-key-here" > .env
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ–¥ï¸ å®Œæ•´åº”ç”¨ï¼ˆæ¨èï¼‰
```bash
# å…‹éš†é¡¹ç›®å¹¶è¿›å…¥ç›®å½•
git clone https://github.com/ylouis83/memory-x.git
cd memory-x

# ä¸€é”®å¯åŠ¨å‰ç«¯+åç«¯
bash scripts/start_all.sh
```

è®¿é—®åœ°å€ï¼š
- ğŸŒ **å‰ç«¯ç•Œé¢**: http://localhost:5173
- ğŸ”Œ **API æœåŠ¡**: http://localhost:5000
- ğŸ“Š **æ¼”ç¤ºé¡µé¢**: http://localhost:5000/demo/mem0

### ğŸ”§ åˆ†åˆ«å¯åŠ¨
```bash
# 1. åç«¯æœåŠ¡
bash scripts/setup_venv.sh
source .venv/bin/activate
bash scripts/run_api.sh

# 2. å‰ç«¯åº”ç”¨ï¼ˆæ–°ç»ˆç«¯ï¼‰
bash scripts/run_frontend.sh
```

### ğŸ’» ä»…åç«¯ API
```bash
# å…‹éš†é¡¹ç›®å¹¶è¿›å…¥ç›®å½•
git clone https://github.com/ylouis83/memory-x.git
cd memory-x

# åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Windows ä½¿ç”¨ venv\\Scripts\\activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

æˆ–ä½¿ç”¨å†…ç½®è„šæœ¬å¿«é€Ÿå¯åŠ¨ï¼š
```bash
bash scripts/setup_venv.sh
source .venv/bin/activate
```

## ğŸš€ å¿«é€Ÿå¼€å§‹
```python
from src.core.memory_manager import MemoryManager

mm = MemoryManager(user_id="user_001")
mm.add_conversation(
    user_message="æˆ‘å«å¼ ä¸‰",
    ai_response="ä½ å¥½å¼ ä¸‰ï¼Œå¾ˆé«˜å…´è®¤è¯†ä½ ï¼",
)
print(mm.search_memories("å¼ ä¸‰"))
```

## ğŸ¨ å‰ç«¯ç•Œé¢

åŸºäº React + TypeScript + Material-UI æ„å»ºçš„ç°ä»£åŒ– Web ç•Œé¢ï¼Œæä¾›å®Œæ•´çš„è®°å¿†ç®¡ç†å¯è§†åŒ–ä½“éªŒï¼š

### ä¸»è¦åŠŸèƒ½æ¨¡å—
- **ğŸ§  æ™ºèƒ½å¯¹è¯**: ä¸AIè¿›è¡Œè‡ªç„¶è¯­è¨€äº¤äº’ï¼Œè‡ªåŠ¨è®°å¿†ç®¡ç†
- **ğŸ” è®°å¿†æµè§ˆ**: æŸ¥çœ‹çŸ­æœŸè®°å¿†å’Œæœç´¢é•¿æœŸè®°å¿†  
- **ğŸ¥ åŒ»ç–—å†³ç­–**: FHIRé£æ ¼çš„ç”¨è¯è®°å¿†åˆå¹¶åˆ†æ
- **ğŸ‘¤ ç”¨æˆ·ç®¡ç†**: å¤šç”¨æˆ·æ”¯æŒå’Œé…ç½®æ–‡ä»¶ç®¡ç†
- **ğŸ“Š ç³»ç»Ÿç›‘æ§**: å®æ—¶APIçŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡

### ç•Œé¢ç‰¹è‰²
- ğŸŒ™ æ˜æš—ä¸»é¢˜åˆ‡æ¢
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯
- ğŸš€ æµç•…çš„åŠ¨ç”»å’Œäº¤äº’ä½“éªŒ
- â™¿ æ— éšœç¢è®¾è®¡æ”¯æŒ

è¯¦ç»†æ–‡æ¡£è¯·å‚è€ƒ [frontend/README.md](frontend/README.md)

Memory-X ä½¿ç”¨ `MemoryStore` æ¥å£å®ç°å¯æ’æ‹”å­˜å‚¨ã€‚

| åç«¯ | è¯´æ˜ |
| --- | --- |
| `SQLiteMemoryStore` | é»˜è®¤æœ¬åœ°å¼€å‘ä½¿ç”¨ï¼Œæ”¯æŒå‘é‡æœç´¢ã€‚ |
| `SpannerMemoryStore` | Cloud Spanner é€‚é…å±‚ï¼ˆç¤ºä¾‹/stubï¼‰ï¼Œå‚è€ƒ Vertex AI çš„å…¨å±€åˆ†å¸ƒå¼è®°å¿†è®¾è®¡ã€‚ |
| `Mem0MemoryStore` | åŸºäº mem0 é¡¹ç›®çš„å­˜å‚¨åç«¯ï¼Œä¾¿äºä¸å…¶ç”Ÿæ€é›†æˆã€‚ |

åˆ‡æ¢åç«¯åªéœ€åœ¨é…ç½®ä¸­æŒ‡å®š `MEMORY_DB_TYPE`ï¼š
```bash
export MEMORY_DB_TYPE=sqlite   # æˆ– spanner æˆ– mem0
```

## ğŸ§­ ç—‡çŠ¶ä¸ç”¨è¯çš„åˆå¹¶è§„åˆ™

é¡¹ç›®åœ¨ `src/core/algorithms_reference.py` ä¸­æä¾›äº†â€œç”¨è¯å‘¨æœŸâ€å’Œâ€œç—‡çŠ¶å‘ä½œâ€çš„ Append/Update/Merge å†³ç­–ä¸ç½®ä¿¡åº¦è¯„åˆ†ï¼š

- ç”¨è¯ï¼š`decide_update_merge_append` / `compute_merge_confidence`
- ç—‡çŠ¶ï¼š`decide_update_merge_append_symptom` / `compute_symptom_merge_confidence`

ç—‡çŠ¶åˆå¹¶ä¸ç”¨è¯ä¸åŒï¼Œæ›´å®½å®¹æ—¶é—´ç©ºçª—ï¼ˆé»˜è®¤ â‰¤14 å¤©ï¼‰ï¼Œå¹¶åœ¨é«˜å±ç—‡çŠ¶ï¼ˆå¦‚èƒ¸ç—›ã€å‘¼å¸å›°éš¾ï¼‰åœºæ™¯æå‡é˜ˆå€¼ä»¥ç¡®ä¿å®‰å…¨ã€‚

## ğŸ©º ç”¨è¯è®°å¿†çš„æ›´æ–°ç­–ç•¥

é¡¹ç›®æ–°å¢çš„ `medical_memory` æ¨¡å—å‚è€ƒ FHIR `MedicationStatement` è®¾è®¡ï¼Œ
æä¾›äº† ``upsert_medication_entry`` æ–¹æ³•ç”¨äºåœ¨ Appendã€Updateã€Merge ä¹‹é—´åšå‡º
å†³ç­–ï¼š

- **Append**ï¼šå‘ç°å…¨æ–°ç–—ç¨‹æˆ–ä¸åŒæ–¹æ¡ˆæ—¶æ–°å¢è®°å½•ï¼›
- **Update**ï¼šåŒä¸€ç–—ç¨‹å†…è¡¥å……å‰‚é‡ã€æ—¶é—´ç­‰å­—æ®µï¼Œè‡ªåŠ¨å¢åŠ ç‰ˆæœ¬å·ï¼›
- **Merge**ï¼šæ£€æµ‹åˆ°è¢«è¯¯åˆ†è£‚çš„ç–—ç¨‹æ—¶åˆå¹¶æ—¶é—´åŒºé—´ï¼Œå¹¶å†™å…¥æ–°çš„ç‰ˆæœ¬ã€‚

æ¯æ¡è®°å½•åŒæ—¶ç»´æŠ¤äº‹å®æ—¶é—´ï¼ˆ`start`/`end`ï¼‰ä¸ç³»ç»Ÿæ›´æ–°æ—¶é—´
ï¼ˆ`last_updated`/`version_id`ï¼‰ï¼Œä¸ºå®¡è®¡å’Œå›æº¯æä¾›åŸºç¡€ã€‚

## âš™ï¸ é…ç½®
æ‰€æœ‰æ•æ„Ÿä¿¡æ¯é€šè¿‡ç¯å¢ƒå˜é‡æä¾›ï¼š
```bash
MEMORY_DB_TYPE=sqlite        # æˆ– spanner æˆ– mem0
MEMORY_DB_PATH=./memory.db   # SQLite æ—¶æœ‰æ•ˆ
MEMORY_DB_USER=your_user     # Cloud Spanner æ—¶ä½¿ç”¨
MEMORY_DB_PASSWORD=your_password
```

## ğŸ§ª æµ‹è¯•
```bash
pytest -q           # æˆ–
bash scripts/test.sh
```

## ğŸ› ï¸ å¸¸ç”¨è„šæœ¬

- `scripts/setup_venv.sh`ï¼šåˆ›å»ºå¹¶åˆå§‹åŒ–è™šæ‹Ÿç¯å¢ƒ
- `scripts/test.sh`ï¼šè¿è¡Œæµ‹è¯•
- `scripts/run_api.sh`ï¼šå¯åŠ¨åç«¯ API æœåŠ¡
- `scripts/run_frontend.sh`ï¼šå¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
- `scripts/start_all.sh`ï¼šä¸€é”®å¯åŠ¨å‰ç«¯+åç«¯æœåŠ¡
- `scripts/clean.sh`ï¼šæ¸…ç†ç¼“å­˜/æ—¥å¿—/æµ‹è¯•æŠ¥å‘Š
- `scripts/push.sh`ï¼šæ¨é€å½“å‰åˆ†æ”¯è‡³è¿œç¨‹

## ğŸ§¹ ä»“åº“å«ç”Ÿ

- å·²é€šè¿‡ `.gitignore` æ’é™¤æœ¬åœ°æ•°æ®åº“ã€æ—¥å¿—ã€ç¼“å­˜ä¸æµ‹è¯•æŠ¥å‘Š JSON æ–‡ä»¶ï¼š
  - `memory_db/*.db*`ã€`logs/`ã€`.pytest_cache/`ã€`.coverage`ã€`tests/*report*.json`ã€`tests/reports/*.json`
- å¦‚éœ€æ¸…ç†å·¥ä½œåŒºä¸­çš„è¿™äº›ç”Ÿæˆæ–‡ä»¶ï¼Œæ‰§è¡Œï¼š
  ```bash
  bash scripts/clean.sh
  ```

## ğŸ“š æ–‡æ¡£
æ›´å¤šè®¾è®¡ç»†èŠ‚ã€API è¯´æ˜å’Œä¸šåŠ¡æµ‹è¯•ç¤ºä¾‹è¯·è§ [docs/](docs) ä¸ [examples/](examples)ã€‚

## ğŸ¤ è´¡çŒ®
æ¬¢è¿æäº¤ Issue æˆ– PRã€‚ä»£ç é£æ ¼éµå¾ª PEP 8ï¼Œå¹¶è¯·é™„å¸¦å•å…ƒæµ‹è¯•ã€‚

## ğŸ“„ è®¸å¯è¯
é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE)ã€‚
